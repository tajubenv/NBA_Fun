"0","scrape_stats <- function(season = 2017){"
"0","  #total stats"
"0","  #scrape"
"0","  url <- paste0(""https://www.basketball-reference.com/leagues/NBA_"",season,""_totals.html"")"
"0","  stats_tot <- url %>% "
"0","    read_html() %>% "
"0","    html_table() %>% "
"0","    .[[1]]"
"0","  "
"0","  #clean"
"0","  player_stats_tot <- stats_tot %>% "
"0","    remove_empty(""cols"") %>%"
"0","    clean_names() %>% "
"0","    dplyr::filter(!player==""Player"") %>%"
"0","    mutate_at(vars(-c(player,tm,pos)),as.numeric) %>% "
"0","    mutate_at(vars(-c(player,tm,pos)), funs(replace(., is.na(.), 0))) %>% "
"0","    as_tibble() %>% "
"0","    group_by(player) %>% "
"0","    slice(1) %>% "
"0","    ungroup() %>% "
"0","    select(-rk)"
"0","  "
"0","  #per minute"
"0","  url <- paste0(""https://www.basketball-reference.com/leagues/NBA_"",season,""_per_minute.html"")"
"0","  stats_pm <- url %>% "
"0","    read_html() %>% "
"0","    html_table() %>% "
"0","    .[[1]]"
"0","  "
"0","  player_stats_pm <- stats_pm %>% "
"0","    remove_empty(""cols"") %>%"
"0","    clean_names() %>% "
"0","    dplyr::filter(!player==""Player"") %>%"
"0","    mutate_at(vars(-c(player,tm,pos)),as.numeric) %>% "
"0","    mutate_at(vars(-c(player,tm,pos)), funs(replace(., is.na(.), 0))) %>% "
"0","    as_tibble() %>% "
"0","    group_by(player) %>% "
"0","    slice(1) %>% "
"0","    ungroup() %>% "
"0","    rename_at(vars(9:29),funs(paste0(.,""_pm""))) %>% "
"0","    select(-rk)"
"0","  "
"0","  #advanced"
"0","  url <- paste0(""https://www.basketball-reference.com/leagues/NBA_"",season,""_advanced.html"")"
"0","  stats_adv <- url %>% "
"0","    read_html() %>% "
"0","    html_table() %>% "
"0","    .[[1]]"
"0","  "
"0","  player_stats_adv <- stats_adv %>% "
"0","    remove_empty(""cols"") %>%"
"0","    clean_names() %>% "
"0","    dplyr::filter(!player==""Player"") %>%"
"0","    mutate_at(vars(-c(player,tm,pos)),as.numeric) %>% "
"0","    mutate_at(vars(-c(player,tm,pos)), funs(replace(., is.na(.), 0))) %>% "
"0","    as_tibble() %>% "
"0","    group_by(player) %>% "
"0","    slice(1) %>% "
"0","    ungroup() %>% "
"0","    select(-rk)"
"0","  "
"0","  player_stats <- full_join(player_stats_tot,player_stats_pm,"
"0","                            by = c(""player"", ""pos"", ""age"", ""tm"", ""g"", ""gs"", ""mp"")) %>% "
"0","    full_join(player_stats_adv,"
"0","              by = c(""player"", ""pos"", ""age"", ""tm"", ""g"", ""mp""))"
"0","  return(player_stats)"
"0","}"
